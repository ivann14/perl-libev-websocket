
<html>
   <head>
	<style>
.circle 
{
    border-radius: 50%;
    width: 50px;
    height: 50px;
    background: red;
}
</style>

      <script type="text/javascript">
		
(function()
         {
	     var ws;
            if ("WebSocket" in window)
            {
               // Let us open a web socket
               ws = new WebSocket("ws://127.0.0.1:2222/tracking");

    		ws.onerror = function(evt) { 
			alert("Error" + evt.data);
 		};	
              
		ws.onopen = function(){ 
			var isIE = document.all?true:false;
			if (!isIE) document.captureEvents(Event.MOUSEMOVE);
			document.onmousemove = getMousePosition;
			
			function getMousePosition(mp) {
	  			var _x;
	  			var _y;
	  			if (!isIE) {
					_x = mp.pageX;
					_y = mp.pageY;
	  			}
	  			if (isIE) {
					_x = event.clientX + document.body.scrollLeft;
					_y = event.clientY + document.body.scrollTop;
	  			}
				var coordinates = { x: _x, y: _y };
				if (ws.readyState === 1) {
					ws.send(JSON.stringify(coordinates));
				}
	  			return true;
			};
               };
			
               ws.onmessage = function (evt) 
               { 
                  	var received_msg = evt.data;
		  	var json = JSON.parse(received_msg);
		 
   			var id = json.id;
			if (json.destroy) {
				document.getElementById(id).remove();
				return;
			}

			var element = document.getElementById(id);
			if (element){
				element.style.position = "absolute";
				element.style.left = json.x+'px';
				element.style.top = json.y+'px';
			}else{
				element = document.createElement('div');
				element.id = json.id;
				element.style.position = "absolute";
				element.style.left = json.x+'px';
				element.style.top = json.y+'px';
				element.className = "circle";

				document.getElementsByTagName('body')[0].appendChild(element);
			}
               };
            }
})();


      </script>
		
   </head>
   <body>
   
<div id="sse">	
Mouse tracking shared between all connected websocket clients.  
</div>
      
   </body>
</html>
